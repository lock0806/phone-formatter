<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <title>ç”µè¯æ ¼å¼è½¬æ¢å™¨</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 700px; margin: auto; }
        textarea { width: 100%; height: 150px; margin-bottom: 10px; font-size: 16px; }
        button { padding: 10px 20px; margin-right: 10px; font-size: 15px; cursor: pointer; }
        #output { white-space: pre-wrap; background: #f0f0f0; padding: 10px; min-height: 100px; font-size: 16px; }
    </style>
</head>
<body>
    <h2>ğŸ“± ç”µè¯å·ç æ ¼å¼è½¬æ¢å™¨</h2>
    <p>ç²˜è´´ä½ çš„å·ç ï¼ˆæ¯è¡Œä¸€ä¸ªï¼Œæ”¯æŒå«åå­—å’Œå„ç§ç¬¦å·ï¼‰ï¼š</p>
    <textarea id="input" placeholder="ä¾‹å¦‚ï¼š&#10;jacqueline ï¼ˆè€é—†ï¼‰  +852 9831 1166"></textarea>
    <br>
    <button onclick="formatNumbers()">è½¬æ¢æ ¼å¼</button>
    <button onclick="downloadTxt()">ä¸‹è½½ä¸º TXT</button>

    <h3>è¾“å‡ºç»“æœï¼š</h3>
    <div id="output"></div>

    <script>
        function formatNumbers() {
            const raw = document.getElementById("input").value;
            const lines = raw.split(/\r?\n/);

            const cleaned = lines.map(line => {
                // æå–æ‰€æœ‰æ•°å­—å’ŒåŠ å·ç»„æˆçš„å­—ç¬¦ä¸²ï¼ˆå¯èƒ½å«ç©ºæ ¼ç­‰ç¬¦å·ï¼‰
                // å…ˆå°è¯•æ‰¾ +852 å¼€å¤´çš„å·ç 
                let match = line.match(/(\+?[\d\s]{8,})/g);

                if (!match) return "";

                // ä»å¤šä¸ªåŒ¹é…é¡¹ä¸­æ‰¾å‡ºåŒ…å«852çš„å·ç æˆ–æœ€æ¥è¿‘ç”µè¯å·ç çš„é‚£ä¸€æ¡
                // è¿™é‡Œä¼˜å…ˆæ‰¾åŒ…å«852çš„å­—ç¬¦ä¸²ï¼Œå¦åˆ™å–ç¬¬ä¸€ä¸ª
                let candidate = match.find(s => s.replace(/\D/g, '').startsWith('852'));
                if (!candidate) candidate = match[0];

                // å»æ‰æ‰€æœ‰éæ•°å­—å­—ç¬¦
                let digits = candidate.replace(/\D/g, '');

                // å¦‚æœæ²¡æœ‰ä»¥852å¼€å¤´ï¼Œè‡ªåŠ¨åŠ ä¸Š
                if (!digits.startsWith('852')) {
                    digits = '852' + digits;
                }

                // åªè¦å‰é¢852 + 8ä½æ•°å­—ï¼Œæˆªæ–­å¤šä½™æ•°å­—ï¼ˆé˜²æ­¢å·ç å¤ªé•¿ï¼‰
                digits = digits.slice(0, 11);

                // åªè¾“å‡ºçº¯æ•°å­—
                return digits;
            }).filter(Boolean);

            document.getElementById("output").textContent = cleaned.join("\n");
        }

        function downloadTxt() {
            const text = document.getElementById("output").textContent;
            const blob = new Blob([text], { type: "text/plain" });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "formatted_numbers.txt";
            link.click();
        }
    </script>
</body>
</html>
